<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>麦桃子的部落格</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="麦桃子的部落格">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="麦桃子的部落格">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="麦桃子的部落格">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="麦桃子的部落格" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://7xruqa.com1.z0.glb.clouddn.com/IMG_myphoto.JPG" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Mai Taozi</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						
						<li>About</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">越努力 越幸运</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Mai Taozi</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://7xruqa.com1.z0.glb.clouddn.com/IMG_myphoto.JPG" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">Mai Taozi</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-java异常处理机制" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/20/java异常处理机制/" class="article-date">
  	<time datetime="2016-09-20T07:46:15.000Z" itemprop="datePublished">2016-09-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/20/java异常处理机制/">java异常处理机制</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>原文<a href="http://blog.csdn.net/hguisu/article/details/6155636" target="_blank" rel="external">http://blog.csdn.net/hguisu/article/details/6155636</a></em></p>
<blockquote>
<p>在面向过程式的变成语言中，我们可以通过返回值来确定方法是否正常执行。比如在一个C语言编写的程序中，如果方法正确的执行返回1，错误则返回0。通过方法的返回值我们并不能获得错误的详细信息，可能因为方法由不同的程序员编写，当同一类错误在不同的方法出现时，返回的结果和错误信息不一致。</p>
</blockquote>
<p>什么是异常？运行时发生的可被捕获和处理的错误。</p>
<h1 id="1-java异常"><a href="#1-java异常" class="headerlink" title="1.java异常"></a>1.java异常</h1><p>异常指不期而遇的各种状况，如文件找不到，网络连接失败，非法参数等。异常是一个事件，它发生运行期间，干扰了正常的指令流程。java通过API中Throwable类的众多子描述各种不同的异常。因而，java异常都是对象，是Throwable子类的实例，描述了出现在一段编码中的错误条件。</p>
<p>java异常类层次结构图：</p>
<p><img src="http://7xruqa.com1.z0.glb.clouddn.com/java%E5%BC%82%E5%B8%B8%E7%B1%BB.PNG" alt=""></p>
<p>在java中，所有的异常都有一个共同的祖先Throwable（可抛出）。Throwalbe指定代码中可用异常传播机制通过java应用程序传播的任何问题的共性。</p>
<font color="blue"><b>Throwable：</b></font>有两个重要的子类：Exception(异常)和Error（错误），二者都是java异常处理的重要子类，各自都包含大量子类<br><br><font color="blue"><b>Error(错误)：</b></font>是程序无法处理的错误，表示运行应用程序中较严重问题。大多数错误与代码编写执行的操作无关，而表示代码运行时JVM（java虚拟机）出现问题。eg，java虚拟机运行错误（Virtual MachineError），当JVM不再有继续执行操作所需的内存资料，将出现OutOfMemoryError。这些异常发生时，Java虚拟机（JVM）一般会选择线程终止。<br><br><font color="blue"><b>Exception(异常)：</b></font>是程序本身可以处理的异常<br><br>Exception类有一个重要的子类RuntimeException。RuntimeException类及其子类表示“JVM常用操作”引发的错误。例如，若视图使用空值对象引用，除数为0或数组越界，则分别引发运行时异常（NullPointerException，ArithmeticException）和ArrayIndexOutOfBoundException。<br><br>除了RuntimeException及其子类以外，其他的Exception类及其子类都属于<font color="blue"><b>可查异常</b></font>。这种异常的特点是Java编译器会检查它，也就是说，当程序中可能出现这类异常，要么用try-catch语句捕获它，要么用throws子句声明抛出它，否则编译不会通过。<br><br><br><font color="blue"><b>为什么Java的checked exception是一个糟糕的特性？</b></font>

<blockquote>
<p>当少量代码时，checked异常无疑是十分优雅的构思，并有助于避免了许多潜在的错误，但是经验表明，对大量代码来说结果正好相反。<br>使用checked异常会带来许多问题</p>
<p>1.checked异常导致了太多的try…catch代码</p>
<p>2.checked异常导致了许多难以理解的代码产生</p>
<p>当开发人员必须去捕获一个自己无法正确处理的checked异常，通常的是重新封装成一个新的异常后再抛出。这样做并没有为程序带来任何好处。反而使代码晚难以理解。就像我们使用JDBC代码那样，需要处理非常多的try…catch.，真正有用的代码被包含在try…catch之内。使得理解这个方法变理困难起来checked异常导致异常被不断的封装成另一个类异常后再抛出。</p>
<p>3.checked异常导致破坏接口方法</p>
<p>一个接口上的一个方法已被多个类使用，当为这个方法额外添加一个checked异常时，那么所有调用此方法的代码都需要修改</p>
</blockquote>
<font color="blue"><b>运行时异常：</b></font>

<blockquote>
<p>都是RuntimeException类及其子类异常，如NullPointerException(空指针异常)、IndexOutOfBoundsException(下标越界异常)等，这些异常是不检查异常，程序中可以选择捕获处理，也可以不处理。这些异常一般是由程序逻辑错误引起的，程序应该从逻辑角度尽可能避免这类异常的发生。运行时异常的特点是Java编译器不会检查它，也就是说，当程序中可能出现这类异常，即使没有用try-catch语句捕获它，也没有用throws子句声明抛出它，也会编译通过。</p>
</blockquote>
<font color="blue"><b>非运行时异常 （编译异常）：</b></font>

<blockquote>
<p>是RuntimeException以外的异常，类型上都属于Exception类及其子类。从程序语法角度讲是必须进行处理的异常，如果不处理，程序就不能编译通过。如IOException、SQLException等以及用户自定义的Exception异常，一般情况下不自定义检查异常。</p>
</blockquote>
<h1 id="2-处理异常机制"><a href="#2-处理异常机制" class="headerlink" title="2.处理异常机制"></a>2.处理异常机制</h1><p>由于运行时异常的不可查性，为了更合理，更容易地实现应用程序，java规定，运行时异常将有java运行时系统自动抛出，允许应用程序忽略运行时异常。</p>
<p>对于所有可查异常，java 规定：一个方法必须捕捉，或者声明抛出方法之外。也就是说，当一个方法选择不捕捉可查异常时，它必须声明将抛出异常。</p>
<p>从方法中抛出的任何异常都必须使用throws字句，捕捉异常通过try-catch语句或者try-catch-finally语句实现。</p>
<h2 id="捕获异常"><a href="#捕获异常" class="headerlink" title="捕获异常"></a>捕获异常</h2><font color="green"><b>1.try-catch语句</b></font>

<p>在java中，异常通过try-catch语句捕获。其一般语法形式为：</p>
<pre><code>try{
    //可能会发生异常的程序代码
}catch(Type1 id1){
     //捕获并处置try抛出的异常类型Type1
}catch(Type2 id2){
     //捕获并处置try抛出的异常类型Type2
}
</code></pre><p>java通过异常类描述异常类型，异常类的层次结构如图所示。对于多个catch子句的异常程序而言，应该尽量捕获底层异常类的catch子句放在前面，同时尽量将捕获相对高层的异常类的catch子句放在后面。否则，捕获地城异常类的catche子句将可能会被屏蔽。</p>
<blockquote>
<p> RuntimeException异常类包括运行时各种常见的异常，ArithmeticException类和ArrayIndexOutOfBoundsException类都是它的子类。因此，RuntimeException异常类的catch子句应该放在最后面，否则可能会屏蔽其后的特定异常处理或引起编译错误。</p>
</blockquote>
<font color="green"><b>2.try-catch-finally语句</b></font>

<p>try-catch语句还可以包括第三部分，就是finally子句。它表示无论是否出现异常，都应当执行的内容。try-catch-finally语句的一般语法形式为：</p>
<pre><code>try{
    //可能会发生异常的程序代码
}catch(Type1 id1){
    //捕获并处理try抛出异常类型Type1
}catch(Type2 id){
    //捕获并处理try抛出的异常类型Type2
}
</code></pre><font color="blue"><b>try，catch，finally语句块的执行顺序</b></font>

<blockquote>
<p>1）当try没有捕获到异常时：try语句块中的语句逐一被执行，程序将跳过catch语句块，执行finally语句块和其后的语句；</p>
<p>2）当try捕获到异常，catch语句块里没有处理此异常的情况：当try语句块里的某条语句出现异常时，而没有处理此异常的catch语句块是，此异常将会抛给JVM处理，finally语句块里的语句还是会被执行，但finally语句块后的语句不会被执行</p>
<p>3）当try捕获到异常，catch语句块里面有处理此异常的情况：在try语句块中是按照顺序来执行的，当执行到某一条语句出现异常时，程序将调到catch块，并与catch语句块逐一匹配，找到与之对应的处理程序，其他的catch语句块将不会被执行，而try语句块中，出现异常之后的语句也不会被执行，catch语句块执行完后，执行finally语句块里的语句，最后执行finally语句块后的语句。</p>
</blockquote>
<h2 id="抛出异常"><a href="#抛出异常" class="headerlink" title="抛出异常"></a>抛出异常</h2><p>任何java代码都可以抛出异常，如：自己编写的代码，来自java开发环境包中代码，或者java运行时系统，无论是谁，都可以通过java的throw语句抛出异常。从方法中抛出的任何异常都必须使用throws子句。</p>
<font color="green"><b>1.throws抛出异常</b></font>

<p>如果一个方法可能会出现异常，但没有能力处理这种异常，可以在方法声明处用throws子句来声明抛出异常。throws语句用在方法定义时声明该方法要抛出的异常类型，如果抛出的是Exception异常类型，则该方法被声明为抛出所有的异常。多个异常可使用逗号分割。throws语句的语法格式为：</p>
<pre><code>methodname throws Exception1，Exception2，...，ExceptionN
</code></pre><p>方法名后的throws Exception1，Exception2，…，ExceptionN为声明要抛出的异常列表。当方法抛出异常列表的异常时，方法将不对这些类型及其子类类型的异常做处理，而抛向调用该方法的方法，由他去处理。例如：</p>
<pre><code>import java.lang.Exception;
public class TestException{
static void pop() throws NegativeArraySizeException{
    int[] arr=new int[-3];//创建数组
}

public static void main(String[] args){
     try{
          pop();
     }catch(NegativeArraySizeException e){
         System.out.println(&quot;pop()方法抛出的异常&quot;); //输出异常信息
     }
}
}
</code></pre><p>使用throws关键字将异常抛给调用者后，如果调用者不想处理该异常，可以继续向上抛出，但最终要有能够处理该异常的调用者。</p>
<font color="blue"><b>throws抛出异常的规则：</b></font>

<blockquote>
<p>1）如果是不可查异常（unchecked exception），即Error，RuntimeException或他们的子类，那么可以不使用throws关键字来声明要抛出的异常，编译仍能顺利通过，但在运行时会被系统抛出。</p>
<p>2）必须声明方法可抛出的任何可查异常（checked exception）。即如果一个方法可能会出现可查异常，要么用try-catch语句捕获，要么用throws子句声明将它抛出，否则会导致编译错误。</p>
<p>3）仅当抛出了异常，该方法的调用者才必须处理或者重新抛出该异常。当方法的调用者物理处理该异常的时候，应该继续抛出。</p>
<p>4）调用方法必须遵循任何客场异常的处理和声明规则。若覆盖一个方法，则不能声明与覆盖方法不同的异常。声明的任何异常必须是被覆盖方法所声明异常的同类或子类。</p>
</blockquote>
<p>例如：</p>
<pre><code>void method1() throws IOException{}  //合法    

//编译错误，必须捕获或声明抛出IOException    
void method2(){    
  method1();    
}    

//合法，声明抛出IOException    
void method3()throws IOException {    
  method1();    
}    

//合法，声明抛出Exception，IOException是Exception的子类    
void method4()throws Exception {    
  method1();    
}    

//合法，捕获IOException    
void method5(){    
 try{    
    method1();    
 }catch(IOException e){…}    
}    

//编译错误，必须捕获或声明抛出Exception    
void method6(){    
  try{    
    method1();    
  }catch(IOException e){throw new Exception();}    
}    

//合法，声明抛出Exception    
void method7()throws Exception{    
 try{    
  method1();    
 }catch(IOException e){throw new Exception();}    
}   
</code></pre><font color="green"><b>2.使用throw抛出异常</b></font>

<p>throw总是出现在函数体重，用来抛出一个Throwalbe类型的异常。程序会在throw语句后立即终止，它后面的语句执行不到，然后在包含他的所有try块中（可能在上层调用函数中）从里向外寻找憨厚与其匹配的catch子句的try块。</p>
<p>我们知道，异常时候异常类的实例对象，我们可以创建异常类的实例对象通过throw语句抛出，该语句的语法格式为：</p>
<pre><code>throw new exceptionname;
</code></pre><p>例如抛出一个IOException类的异常对象：</p>
<pre><code>throw new IOException;
</code></pre><p>要注意的是，throw 抛出的只能够是可抛出类Throwable 或者其子类的实例对象。下面的操作是错误的：</p>
<pre><code>throw new String(&quot;exception&quot;);
</code></pre><p>这是因为String 不是Throwable 类的子类。</p>
<p>如果抛出了检查异常，则还应该在方法头部声明方法可能抛出的异常类型。该方法的调用者也必须检查处理抛出的异常。</p>
<p>如果所有方法都层层上抛获取的异常，最终JVM会进行处理，处理也很简单，就是打印异常消息和堆栈信息。如果抛出的是Error或RuntimeException，则该方法的调用者可选择处理该异常。</p>
<pre><code>package Test;  
import java.lang.Exception;  
public class TestException {  
    static int quotient(int x, int y) throws MyException { // 定义方法抛出异常  
        if (y &lt; 0) { // 判断参数是否小于0  
            throw new MyException(&quot;除数不能是负数&quot;); // 异常信息  
        }  
        return x/y; // 返回值  
    }  
    public static void main(String args[]) { // 主方法  
        int  a =3;  
        int  b =0;   
        try { // try语句包含可能发生异常的语句  
            int result = quotient(a, b); // 调用方法quotient()  
        } catch (MyException e) { // 处理自定义异常  
            System.out.println(e.getMessage()); // 输出异常信息  
        } catch (ArithmeticException e) { // 处理ArithmeticException异常  
            System.out.println(&quot;除数不能为0&quot;); // 输出提示信息  
        } catch (Exception e) { // 处理其他异常  
            System.out.println(&quot;程序发生了其他的异常&quot;); // 输出提示信息  
        }  
    }  

}  
class MyException extends Exception { // 创建自定义异常类  
    String message; // 定义String类型变量  
    public MyException(String ErrorMessagr) { // 父类方法  
        message = ErrorMessagr;  
    }  

    public String getMessage() { // 覆盖getMessage()方法  
        return message;  
    }  
}  
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-java学习路线图" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/18/java学习路线图/" class="article-date">
  	<time datetime="2016-09-18T02:40:28.000Z" itemprop="datePublished">2016-09-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/18/java学习路线图/">java学习路线图</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>转载于北邮人<a href="https://bbs.byr.cn/#!article/Java/33514?p=1" target="_blank" rel="external">https://bbs.byr.cn/#!article/Java/33514?p=1</a></em></p>
<p>Java是一个通用的编程语言，其实可以干很多事，怎么学Java就看怎么用了。</p>
<p>但有一些一般的步骤：</p>
<ol>
<li><p>熟悉一种文本编辑器，比如Vim, Emacs, Notepad++, TextMate等。知道哪些是开源的，哪些是闭源的，哪些要收费。养成不用盗版软件的习惯。</p>
</li>
<li><p>安装JDK（建议用你的Linux发行版自带的软件包管理器安装openjdk，过程中可能需要读发行版特定的文档）</p>
</li>
<li><p>写一个Java的Hello world程序，并用命令行工具javac编译，再用java命令运行这个程序。过程中熟悉源代码、字节码、虚拟机这些东西，以及Java的包（package）对.class文件所在的路径的影响。</p>
<p>3.5. 如果这两个命令行工具使用熟练了，可以开始选一个喜欢的集成开发环境，比如Eclipse。当然，养成不用盗版软件的习惯。熟悉一下如何建立“工程”，以及快捷键的使用。</p>
</li>
<li><p>学习Java的面向过程编程，包括基本数据结构、表达式、语句、控制流、函数调用。</p>
</li>
<li><p>学习Java的面向对象编程，包括类、引用类型和值类型的区别、成员、方法、访问控制、继承、多态、接口、接口实现。顺便学习一下面向对象的基本思想，即对象、消息、封装、继承、多态等，这些通用的内容不是Java特有的。</p>
<p>5.5 这时候应该已经涉及了Java的垃圾回收。要留意即使有垃圾回收的情况下也会发生的内存泄露（如自己设计数组容器，元素是引用，逻辑上删除了元素，但并没有清成null）。注意垃圾回收只能回收内存中的对象，除了内存以外，其它资源不能依靠垃圾回收来关闭。比如，文件、管道、Socket、数据库连接等，垃圾回收是不会帮你关闭的。</p>
</li>
<li><p>学习Java的异常处理，但更重要的是学习什么时候用特殊返回值而不使用异常，什么时候应该抛出异常而不处理异常，知道什么是pokemon catch及其危害，了解为什么Java的checked exception是一个糟糕的特性。如果愿意，同时学习一下Java1.7的try-with-resource语句和AutoCloseable接口。</p>
</li>
<li><p>熟悉Java常用的数据结构，如基本的数组类型，以及泛型容器（java.util.*），尤其是java.util.List<t>接口和java.util.ArrayList<t>实现；以及java.util.Map<t,u>接口和java.util.HashMap<t,u>实现。（java1.5以前的没有泛型参数的就不用碰了）同时留意一下基本类型int, double等和装箱类型Integer和Double的区别，以及它们是如何自动转换的。</t,u></t,u></t></t></p>
</li>
<li><p>熟悉Java标准库里的各种工具，包括日期时间、字符串格式化、IO等。知道文件要自己在finally子句中close()，或者用Java1.7的try-with-resource，不要妄想垃圾回收器会帮你关掉文件。</p>
</li>
<li><p>学习一下Java的命名习惯，以及JavaBeans的常规，知道为什么getter/setter比直接操作成员变量好。按这种方式给Java的变量、方法命名。同时看看你的IDE能不能自动帮你生成getter和setter。</p>
</li>
<li><p>使用一个第三方的库（比如Apache Commons Lang通用工具库），让你的程序依赖于它的二进制jar包（而不是直接拷贝源代码），用命令行编译、运行（注意classpath等）；也熟悉一下如何用你的集成开发环境添加第三方依赖。感受一下手动管理依赖关系的麻烦。</p>
</li>
<li><p>学习Maven的使用，试着让Maven帮你解决依赖关系，再试着让Maven帮你创建一个Eclipse工程。再试试用Maven打包发布。</p>
</li>
<li><p>学习软件测试，以及JUnit的使用，以及怎么在IDE中使用JUnit。有空看一下coverage工具。</p>
</li>
<li><p>读读四人帮写的《设计模式》（这本书是用C++和Smalltalk语言为例子的，但仍然适合Java）。具体的是这本书， <a href="http://www.amazon.com/Design-Patterns-Elements-Reusable-Object-Oriented/dp/0201633612" target="_blank" rel="external">http://www.amazon.com/Design-Patterns-Elements-Reusable-Object-Oriented/dp/0201633612</a> 图书馆应该能还借到英文原版，因为我借到过。</p>
</li>
</ol>
<h2 id="接下来就看具体要做哪方面的应用了，看需求。比如（下面的没有顺序）"><a href="#接下来就看具体要做哪方面的应用了，看需求。比如（下面的没有顺序）" class="headerlink" title="接下来就看具体要做哪方面的应用了，看需求。比如（下面的没有顺序）"></a>接下来就看具体要做哪方面的应用了，看需求。比如（下面的没有顺序）</h2><font color="green"><b>【….】如果学Java学得不舒服了，学Python。</b></font>

<blockquote>
<ul>
<li>如果对面向对象编程的概念有点不习惯，学Smalltalk。（Ruby也行，但不如Smalltalk经典。Ruby的文档是一大硬伤。）</li>
<li>如果嫌Java太啰嗦，学Python</li>
<li>如果嫌Java太啰嗦，又想用JVM，自己又有精力，学Scala</li>
<li>如果对对象之间的关系有点晕，学一学UML，以及它的一些图，可以对程序和运行进行直观的建模。你的IDE也许有插件可以生成UML图。但是不要太沉迷于这些方法论。</li>
</ul>
</blockquote>
<font color="green"><b>【调试和辅助工具】学习一下你的集成开发环境提供的调试工具，加一些断点试试 </b></font>

<blockquote>
<ul>
<li>试试用jconsole或者VisualVM监控另一个jvm的状态。</li>
<li>用profiling工具寻找程序中慢的地方。Eclipse有profiling工具。VisualVM也有这样的功能。（如果不介意使用闭源软件的话，也试试JProfiler和YourKit）</li>
<li>有的JVM允许在运行时更新代码。Eclipse可以和某些JVM集成。这样你可以频繁修改代码而不用频繁重启JVM。对于某些“重型”工程很有用。（如果不介意使用闭源软件的话，也试试jRebel）</li>
</ul>
</blockquote>
<font color="green"><b>【多线程】学习Java的多线程编程以及lock、condition的用法（包括传统Java的synchronized语句以及新加的java.util.concurrent.*），学习一下如何让线程停下来，以及为什么要频繁确认isInterrupted()而不要用Thread.stop()。了解一下多核处理器、缓存、内存的关系，以及为什么多线程编程这么难。</b></font>

<blockquote>
<ul>
<li>如果还舒服，学习一下Runnable的用法，以及自带的Executer等基本多线程工具。</li>
<li>应该已经留意到java.util里面的很多容器不是线程安全的，但是java.util.Collections可以帮你创建一些安全的版本。另外关注一下java.util.concurrent里面有ConcurrentMap等容器可供使用。</li>
<li>如果有空的话，看看memory model（内存一致性模型）和无锁同步（见java memory model和java.util.concurrent.atomic）。</li>
<li>如果还有空，再了解一下除了“共享内存多线程编程”以外有没有别的模型（多进程multi-processing、消息传递message passing等）。</li>
</ul>
</blockquote>
<font color="green"><b>【反射、元编程】学习Java的反射机制，以及Annotation的用法。</b></font>

<blockquote>
<ul>
<li>如果还舒服，试试java.lang.reflect.Proxy的用法。</li>
<li>如果仍然还舒服，玩一玩CGLib（一个第三方的库）。</li>
</ul>
</blockquote>
<font color="green"><b>【网络编程】学习一下IP, TCP协议（计算机专业的应该学过，复习一下），学习Socket编程（注意垃圾回收器不会帮你关掉Socket）。</b></font>

<blockquote>
<ol>
<li>如果不是很关心HTTP，看看java.nio，学习单线程轮询式IO复用（Selector）。<ul>
<li>如果有点不明白nio的意图的话，了解一下c10k问题。 <a href="http://www.kegel.com/c10k.html" target="_blank" rel="external">http://www.kegel.com/c10k.html</a></li>
<li>如果身体没有异样的话，大概了解一下操作系统（包括C语言）提供的select, poll, epoll, kqueue等接口。</li>
<li>如果身体仍然没有异样的话，试着用java.nio写一个文件服务器。</li>
<li>如果还有精力的话，上网扒一扒有没有其他的通信库，如netty等。</li>
</ul>
</li>
<li>如果关心Web还有HTTP，就学习一下HTTP协议，以及用Java进行HTTP的客户端编程。<ul>
<li>如果还舒服，学学HTML，写写HTML的静态网页（不需要Java）</li>
<li>如果还舒服，用Java写一个基于DOM、XPath或者CSS Selector的网页解析器（爬网页）。</li>
<li>如果还舒服，学学Java的Servlet接口（先别学jsp）进行Web服务器端编程。学学标准的Servlet容器怎么用，包括web.xml的用法以及listener、filter等概念。以及某个Servlet容器（如Jetty或者Tomcat）的具体用法。</li>
<li>如果仍然还舒服，试着学一种模板语言（如haml, velocity, freemarker，【还有其他更好的框架吗？我不知道】, String.format，如果真的想学JSP的话JSP倒是也行，但不推荐）。</li>
<li>如果仍然觉得舒服，学学Spring框架中的Web框架，或者Struts，看你的口味。</li>
<li>如果还舒服，看看Spring Bean Container以及里面各种乱七八糟的工具。</li>
<li>如果还舒服，或者有需求，了解一下什么是RESTful Web Service，复习一下HTTP，找找适合的Java工具。</li>
<li>你可能会觉得Jackson是一个解析JSON用的好用的东西。</li>
</ul>
</li>
</ol>
</blockquote>
<font color="green"><b>【数据库】学习一下关系数据库（计算机专业的应该学过，复习一下），包括SQL。选一个数据库管理系统熟悉一下（比如MariaDB，或者（如果你不讨厌Oracle的话）用被Oracle收购了的MySQL。先脱离Java单独学学）。然后看它们的官方文档教你怎么用Java连接这种数据库。这中间会涉及到JDBC接口。同时一定要知道SQL注入安全漏洞，以及掌握如何用PreparedStatement防止注入！！。建议看 <a href="http://bobby-tables.com/" target="_blank" rel="external">http://bobby-tables.com/</a></b></font>

<blockquote>
<ul>
<li>可能中间会涉及“事务”问题，让你不知不觉地开始去了解java transaction api(JTA)。</li>
<li>如果还舒服，学一学对象关系转换（如Hibernate）。</li>
<li>也可以学学非关系数据库，以及如何用Java访问它们。</li>
</ul>
</blockquote>
<font color="green"><b>【日志记录】学习一下slf4j和logback的用法。</b></font>

<blockquote>
<ul>
<li>如果有精力的话，大概了解一下世界上有多少种Java日志框架，以及slf4j是怎么桥接这些框架的。</li>
</ul>
</blockquote>
<font color="green"><b>【构建(build)系统】学习一下Ant的用法。</b></font>

<blockquote>
<ul>
<li>如果还舒服的话，学习一下用Ivy从Maven的仓库里下载软件包，解决依赖关系。</li>
</ul>
</blockquote>
<font color="green"><b>【版本控制】学习一种分布式版本控制器（如Git、Mercurial、Bzr、Darcs等，推荐Git）的基本用法，以及如何用它管理Java工程。希望你已经开始使用Maven了，并且知道为什么把IDE生成的工程文件（如eclipse的.project，.classpath和.metadata）放入版本控制器不好。然后了解一下如何在IDE中使用版本控制（Eclipse自带Git插件）。</b></font>

<blockquote>
<ul>
<li>如果感觉很舒服的话，为你们实验室搭建一个Linux+SSH+Git服务器，装个GitLab（一种Web界面）。</li>
<li>了解“集中式版本控制器”和“分布式版本控制器”的区别，并说服同事们不要再用SVN、CVS或者SourceSafe等老旧的“集中式版本控制器”了。</li>
<li>开设一个GitHub账户。如果你不喜欢Git，就用BitBucket等。</li>
</ul>
</blockquote>
<font color="green"><b>【持续集成】自己（或者为你们实验室）搭建一个持续集成（Continuous Integration）服务器，如Jenkins，定期编译你的程序。建议同时使用Git等分布式版本控制器。</b></font>

<blockquote>
<ul>
<li>如果你做开源软件，试试GitHub和Travis。</li>
</ul>
</blockquote>
<font color="green"><b>【零碎工具】淘一淘java.nio.files里面有什么好用的东东，然后再淘一淘Apache Commons Lang和Commons IO里有什么好用的工具。Commons Logging就不要再用了，用SLF4j和Logback。</b></font>


<font color="green"><b>【XML】学学XML、DOM、XPath。XML这东西到处都可能用到。也可以用它写自己的配置文件。</b></font>

<blockquote>
<ul>
<li>如果觉得不舒服了，就学学JSON和YAML。</li>
<li>如果还是不舒服，就学学文本文件解析。</li>
</ul>
</blockquote>
<font color="green"><b>【语法分析和编译器】学学Antlr或者别的Parser Generator的用法</b></font>

<blockquote>
<ul>
<li>如果觉得舒服，自己写一个计算器。</li>
<li>如果还觉得舒服，自己写一种Domain-Specific Language (DSL)。</li>
</ul>
</blockquote>
<font color="green"><b>【高效容器】学学FastUtil或者Trove，如果你需要进行大量数值运算的话。</b></font>


<font color="green"><b>【分布式计算】学学MapReduce的思想以及它的实现。</b></font>

<blockquote>
<ul>
<li>如果还舒服，学学Scala语言以及号称比MapReduce快得多的Apache Spark。</li>
</ul>
</blockquote>
<font color="green"><b>【进程间通信】看看ActiveMQ、MINA和RMI。</b></font>


<font color="green"><b>【其他语言（JVM）】学习另一门跑在JVM上的语言或者实现（如Groovy、Scala、Clojure、JRuby、Jython、JavaScript……）</b></font>

<blockquote>
<ul>
<li>如果还舒服，学一学Java Scripting API（注意不是JavaScript。给个链接： <a href="http://docs.oracle.com/javase/6/docs/technotes/guides/scripting/programmer_guide/" target="_blank" rel="external">http://docs.oracle.com/javase/6/docs/technotes/guides/scripting/programmer_guide/</a> ），然后试着在自己的Java程序里嵌入脚本。</li>
</ul>
</blockquote>
<font color="green"><b>【其他语言（非JVM）】学习另一门通用脚本语言（如Python、Ruby，其实perl也行，但不推荐），知道什么时候Java不是最好的选择。</b></font>


<font color="green"><b>【Java语言和Java虚拟机】通读一遍（一目十行地读，不用细读）Java Language Specification，以及Java Virtual Machine Specification。</b></font>

<blockquote>
<ul>
<li>了解以下解释器（interpreter）、编译器（compiler）、即时编译器（just-in-time compiler）和优化器（optimiser）的概念。</li>
<li>如果对编译器的话题不感到畏惧，了解一下method JIT和tracing JIT的概念和区别。</li>
</ul>
</blockquote>
<font color="green"><b>【内存管理】学学垃圾回收的几种基本算法，包括mark-sweep、mark-compact、semi-space、generational、mark-region等，各自的性能，以及为什么朴素的reference counting是不完整的。知道为什么finalizer性能很糟糕，而且标准并不要求finalizer在程序退出前一定会执行。</b></font>

<blockquote>
<ul>
<li>如果还舒服，了解一下如何设置Java虚拟机的堆大小限制（如HotSpot虚拟机的-Xmx选项等）。</li>
<li>了解一下Java里的WeakReference以及SoftReference和PhantomReference，以及它们什么时候有用，以及为什么它们实现起来有些困难。</li>
<li>如果有精力，了解一下Hotspot虚拟机的内存管理算法是什么样的。</li>
</ul>
</blockquote>
<font color="green"><b>【动态装载】学学Java的动态装载（class loading）</b></font>

<blockquote>
<ul>
<li>如果还舒服的话，学学OSGI以及它的一种实现（如Felix或者Equinox）</li>
<li>如果仍然很舒服的话，学学写基于Eclipse平台的程序。不是Eclipse集成开发环境，只是利用他们的图形框架，写自己的应用程序。</li>
<li>如果还觉得舒服的话，写Eclipse集成开发环境的插件。</li>
</ul>
</blockquote>
<font color="green"><b>【本地/外语接口】学习一下Java Native Interface（JNI），试着写一个Java和C语言混合编程的程序。</b></font>

<blockquote>
<ul>
<li>如果觉得不舒服了或者觉得欲仙欲死，就学一学Java Native Access（JNA），试一试不用任何胶水代码而从Java直接装载C库，直接调用C函数。</li>
<li>如果连JNA也懒得学，就学一学SWIG，自动生成绑定。</li>
<li>如果觉得舒服，就学一学Java Virtual Machine Tooling Interface（JVMTI），用C程序来监视JVM的状态。</li>
</ul>
</blockquote>
<font color="green"><b>【密码学】学一学密码学，包括编码、密码分析、攻击、对称密钥、公钥系统、数字签名、哈希算法等，看看Java有没有实现。</b></font>

<blockquote>
<ul>
<li>如果觉得有点不舒服（你应该不会觉得舒服吧，除非你是学密码学的，要不然总会觉得自己写的程序有安全漏洞），就写一个“人品计算器”来放松一下，要求每次输入同一个姓名，得到的人品值是固定的，但又要让人无法用别人的人品值猜自己的人品值。</li>
</ul>
</blockquote>
<font color="green"><b>【移动终端】学一学Android开发。</b></font>

<blockquote>
<ul>
<li>如果有精力的话，看看Dalvik虚拟机是怎么回事。</li>
<li>建议买一个iPhone或者iPad，或许你再也不想用Android手机或者平板了。</li>
</ul>
</blockquote>
<font color="green"><b>【历史】如果觉得有些无聊，就去挖一挖历史上比较火的可能和Java相关技术，比如：</b></font>

<blockquote>
<ul>
<li>Applet，想想它比起html5+css3+javascript的缺点在哪里。</li>
<li>AWT、Swing，想想为什么很少有人用Java写图形界面程序。你觉得Swing的程序看上去舒服吗？中国人和残疾人喜欢用Swing程序吗？</li>
<li>JNDI，想想它比起Spring Bean Container的缺点在哪里。</li>
<li>JSP，想想它比起MVC结构的缺点在哪里。</li>
<li>WSDL/SOAP，把它们和XML-RPC、RESTful Web Service比较一下。</li>
<li>XSLT，以及为什么它是图灵完备的。可是它真的比Java本身更好用吗？</li>
<li>Log4j、java.util.logging、Apache Commons Logging，各自有什么问题，以及Log4j的作者本人为什么又开发了SLF4j和Logback？</li>
<li>Java最早是为什么设计的？</li>
<li>Type erasure是怎么回事？为什么ArrayList<int>不行但ArrayList<integer>就可以？挖一挖历史。</integer></int></li>
</ul>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-java导出批量文件，打包下载" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/08/30/java导出批量文件，打包下载/" class="article-date">
  	<time datetime="2016-08-30T06:44:02.000Z" itemprop="datePublished">2016-08-30</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/30/java导出批量文件，打包下载/">java导出批量文件，打包下载</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-获取json格式的数据"><a href="#1-获取json格式的数据" class="headerlink" title="1.获取json格式的数据"></a>1.获取json格式的数据</h2><p>Json-lib包是一个beans,collections,maps,java arrays 和XML和Json相互转换的包，主要就是用来解析Json数据</p>
<p>需要导入的依赖包</p>
<blockquote>
<p>commons-beanutils-1.7.0.jar<br>commons-collections-3.2.jar<br>commons-lang-2.4.jar<br>commons-logging-1.1.jar<br>ezmorph-1.0.4.jar<br>json-lib-2.2.3-jdk13.jar</p>
</blockquote>
<p><strong>JSONArray和JSONObject的区别</strong></p>
<pre><code>{
&quot;cat&quot;:&quot;it&quot;,
&quot;language&quot;:[
    {&quot;id&quot;:1,&quot;ide&quot;:&quot;eclipse&quot;,&quot;name&quot;:Java},
    {&quot;id&quot;:2,&quot;ide&quot;:&quot;XCode&quot;,&quot;name&quot;:&quot;Swift&quot;},
    {&quot;id&quot;:3,&quot;ide&quot;:&quot;Visual Stdio&quot;,&quot;name&quot;:&quot;C#&quot;}     
],
&quot;pop&quot;:true
}
</code></pre><p>JsonArray array=object.get(“language”).getAsJsonArray();   </p>
<pre><code>{
&quot;resultcode&quot;: &quot;200&quot;,
&quot;reason&quot;: &quot;successed!&quot;,
&quot;result&quot;: {
    &quot;sk&quot;: {
        &quot;temp&quot;: &quot;24&quot;,
        &quot;wind_direction&quot;: &quot;西南风&quot;,
        &quot;wind_strength&quot;: &quot;2级&quot;,
        &quot;humidity&quot;: &quot;51%&quot;,
        &quot;time&quot;: &quot;10:11&quot;
    }
}
}
</code></pre><p>JsonObject result=json.get(“result”).getAsJsonObject();</p>
<p><strong>转化成json数据</strong></p>
<p><1>List集合转化成json方法</1></p>
<pre><code>List list = new ArrayList();
list.add( &quot;first&quot; );
list.add( &quot;second&quot; );
JSONArray jsonArray2 = JSONArray.fromObject( list );
</code></pre><p><2>Map集合转换成json方法</2></p>
<pre><code>Map map = new HashMap();
map.put(&quot;name&quot;, &quot;json&quot;);
map.put(&quot;bool&quot;, Boolean.TRUE);
map.put(&quot;int&quot;, new Integer(1));
map.put(&quot;arr&quot;, new String[] { &quot;a&quot;, &quot;b&quot; });
map.put(&quot;func&quot;, &quot;function(i){ return this.arr[i]; }&quot;);
JSONObject json = JSONObject.fromObject(map);
</code></pre><p><3>数组转化成json代码</3></p>
<pre><code>boolean[] boolArray = new boolean[] { true, false, true };
JSONArray jsonArray1 = JSONArray.fromObject(boolArray);  
</code></pre><h2 id="2-循环写入文件"><a href="#2-循环写入文件" class="headerlink" title="2.循环写入文件"></a>2.循环写入文件</h2><pre><code> List&lt;String&gt; file =new ArrayList&lt;String&gt;();
 List&lt;File&gt; files=new ArrayList&lt;File&gt;();

 //项目当前的根目录
 String path=request.getSession().getServletContext().getRealPath(File.separator) 

 JSONObject obj=jsonObj.getJSONObject(&quot;ret_info&quot;).getJSONObject(&quot;ret&quot;);

 //根据一个Json数据，循环写入多个文件
 Iterator it=obj.keys();

 while(it.hasNext()){
     String fileName=(String) it.next();
     file.add(fileName);

     File toFile=new File(path+fileName+&quot;.txt&quot;);
     if(!toFile.exists()){
           toFile.createNewFile();
     }
     //文件输出流
     FileoutputStream fos=new FileOutputStream(toFile);
     StringBuffer write=new StringBuffer();

     //要写入文件的内容
     write.append（&quot;*******************&quot;）;
     ...

     try{
        fos.write(write.toString().getBytes(&quot;UTF-8&quot;));
     }
     catch(Exception e){
         e.printStackTrace();
     }
     finally{
         fos.flush();
         fos.close();
 }
}
</code></pre><h2 id="3-文件打包"><a href="#3-文件打包" class="headerlink" title="3.文件打包"></a>3.文件打包</h2><pre><code>for(int i=0;i&lt;file.size();i++){
   String table=file.get(i);
   File tempFile=new File(path+table+&quot;.txt&quot;);
   files.add(tempFile);
}

BufferedInputStream bfs=null;
byte data[]=new byte[1024];
FileOutputStream dest=new FileOutputStream(path+&quot;/&quot;+&quot;导出数据.zip&quot;);
ZipOutputStream out=new ZipOutputStream(new BufferedOutputStream(dest));

for (int i = 0; i &lt; files.size(); i++) {

                 int count;
                 FileInputStream fis = new FileInputStream(files.get(i));
                 bfs = new BufferedInputStream(fis);
                 ZipEntry entry = new ZipEntry(files.get(i).getName());
                 out.putNextEntry(entry);
                 while ((count = bfs.read(data, 0, 1024)) != -1) {
                      out.write(data, 0, count);
                 }
                 bfs.close();
            }
            out.close();
</code></pre><h2 id="4-文件下载"><a href="#4-文件下载" class="headerlink" title="4.文件下载"></a>4.文件下载</h2><pre><code>File filedown=new File(path+&quot;/&quot;+&quot;导出数据.zip&quot;);
            response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename=&quot;
                    + &quot;data.zip&quot;);
            response.setContentLength((int) filedown.length());
            response.setContentType(&quot;application/zip&quot;);// 定义输出类型
            try{
                FileInputStream fis = new FileInputStream(filedown);
                BufferedInputStream buff = new BufferedInputStream(fis);
                byte[] b = new byte[1024];// 相当于我们的缓存
                long k = 0;// 该值用于计算当前实际下载了多少字节
                OutputStream myout = response.getOutputStream();// 从response对象中得到输出流,准备下载
                // 开始循环下载
                while (k &lt; filedown.length()) {
                    int j = buff.read(b, 0, 1024);
                    k += j;
                    myout.write(b, 0, j);
                }
                myout.flush();
            } catch (Exception e) {
                System.out.println(e);
            }
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-全文检索相关知识总结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/08/02/全文检索相关知识总结/" class="article-date">
  	<time datetime="2016-08-02T06:48:58.000Z" itemprop="datePublished">2016-08-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/02/全文检索相关知识总结/">全文检索相关知识总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-全文检索基本原理"><a href="#1-全文检索基本原理" class="headerlink" title="1.全文检索基本原理"></a>1.全文检索基本原理</h2><p>我们生活中的数据总体分为两种：结构化数据和非结构化数据</p>
<blockquote>
<p>结构化数据：指具有固定格式或有限长度的数据，如数据库，元数据等</p>
<p>非结构化数据：指不定长或无固定格式的数据，如邮件，word文档等</p>
</blockquote>
<p>当然有的地方还会提到第三种，半结构化数据，如XML，HTML等，当根据需要可按结构化数据来处理，也可抽取出纯文本按非结构化数据来处理。<font color="red">非结构化数据又有一种叫法叫全文数据。</font></p>
<p>按照数据的分类，搜索也分为两种：</p>
<blockquote>
<p>对结构化数据的搜索：如对数据库的搜索，用SQL语句。再如对元数据的搜索，如利用windows搜索对文件名，类型，修改时间进行搜索等。</p>
<p>对非结构化数据的搜索：如利用windows的搜索也可以搜索文件内容，Linux下的grep命令，再如用Google和百度可以搜索大量内容数据</p>
</blockquote>
<font color="red">这种先建立索引，再对索引进行搜索的过程就叫全文检索（Full-text Search）。</font>

<p>全文检索答题分为两个过程，索引创建（Indexing）和搜索索引（Search）。</p>
<blockquote>
<p>索引创建：将现实世界中所有的结构化和非结构化数据提取信息，创建索引的过程。</p>
<p>搜索索引：就是得到用户的查询请求，搜索创建的索引，然后返回结果的过程。</p>
</blockquote>
<h2 id="2-索引里面究竟存些什么"><a href="#2-索引里面究竟存些什么" class="headerlink" title="2.索引里面究竟存些什么"></a>2.索引里面究竟存些什么</h2><p>由于从字符串到文件的映射是文件到字符串的反向过程，于是保存这种信息的索引称为<strong>反向索引</strong></p>
<p>反向索引的所保存的信息一般如下：</p>
<p>假设我的文档集合里面有100篇文章，为了方便表示，我们为文档编号从1到100，得到下面的结构</p>
<p><img src="http://7xruqa.com1.z0.glb.clouddn.com/%E5%80%92%E6%8E%92.jpg" alt=""></p>
<p>左边保存的是一系列字符串，称为词典。每个字符串都指向包含此字符串的文档（Document）链表，此文档链表称为倒排表（Posting List）。有了索引，便使保存的信息和要搜索的信息一致，可以大大加快搜索的速度。比如说，我们要寻找包含字符串“lucene”又包含字符串“solr”的文档，我们只需要以下几步：</p>
<blockquote>
<p>1.取出包含字符串“lucene”的文档链表</p>
<p>2.取出包含字符串“solr”的文档链表</p>
<p>3.通过合并链表，找出既包含“lucene”又包含“solr”的文件</p>
</blockquote>
<p>看到这个地方，有人可能会说，全文检索的确加快了搜索的速度，但是多了索引的过程，两者加起来不一定比循序扫描快多少。的确，加上索引的过程，全文检索不一定比顺序扫描快，尤其是在数据量小的时候更是如此。而对一个很大量的数据创建索引也是一个很慢的过程。</p>
<p>然而两者还是有区别的，顺序扫描是每次都要扫描，而创建索引的过程仅仅需要一次，以后便是一劳永逸了，每次搜索，创建索引的过程不必经过，仅仅搜索创建好的索引就可以了。</p>
<font color="red">这也是全文搜索相对于顺序扫描的优势之一，一次索引，多次使用。</font>

<h2 id="3-如何创建索引"><a href="#3-如何创建索引" class="headerlink" title="3.如何创建索引"></a>3.如何创建索引</h2><p><strong>第一步:一些要索引的原文档</strong></p>
<p><strong>第二步：将源文档传给分词组件</strong></p>
<p>分词组件（Tokenizer）会做以下几件事情（此过程称为Tokenize）</p>
<p>1.将文档分成一个一个单独的单词</p>
<p>2.去除标点符号。</p>
<p>3.去除停词</p>
<p>所谓停词（Stop word）就是一种语言中最普通的一些单词，由于没有特别的意义，因而大多数情况下不能称为搜索的关键词，因而创建索引时，这种词会被去掉而减少索引的大小。</p>
<p><strong>第三步：将得到的词元（Token）传给语言处理组件（Linguistic Processor）</strong></p>
<p>语言处理组件（linguistic processor）主要是对得到的词元（Token）做一些同语言相关的处理。对于英语，语言处理组件（Linguistic Processor）一般做以下几点：</p>
<p>1.变为小写（Lowercase）</p>
<p>2.将单词缩减为词根形式，如“cars”到“car”等，这种操作称为：stemming</p>
<p>3.将单词转变为词根形式，如“cars”到“car”等，这种操作称为:lemmatization</p>
<p>语言处理组件（linguistic processor）的结果称为词（Term）。<br>也正是因为有语言处理的步骤，才能使搜索drove,而drive也能被搜索出来。</p>
<p><strong>第四步：将得到的词（Term）传给索引组件（Indexer）</strong></p>
<p>索引组件（Indexer）主要做以下几件事情：</p>
<p>1.利用得到的词（Term）创建一个字典</p>
<p>2.对字典按字母顺序进行排序</p>
<p>3.合并相同的词（Term）成为文档倒排（Posting List）链表</p>
<h2 id="4-如何对索引进行搜索"><a href="#4-如何对索引进行搜索" class="headerlink" title="4.如何对索引进行搜索"></a>4.如何对索引进行搜索</h2><p><strong>第一步：用户输入查询语句。</strong> </p>
<p>eg. lucene AND learned NOT hadoop</p>
<p><strong>第二步：对查询语句进行词法分析，语法分析，及语言处理</strong></p>
<p>1.词法分析主要用来识别单词和关键字</p>
<p>单词：lucene，learned，hadoop 关键字：AND ， NOT</p>
<p>2.语法分析主要是根据查询语句的语法规则来形成一颗语法树。</p>
<p>3.语言处理同索引过程中的语言处理几乎相同。</p>
<p><strong>第三步：搜索索引，得到符合语法树的文档</strong></p>
<p>此步骤又分几小步</p>
<p>1.首先，在反向索引表中，分别找出包含lucene , learn, hadoop的文档链表。</p>
<p>2.其次，对包含lucene，learn的链表进行合并操作，得到既包含lucune又包含learn的文档链表</p>
<p>3.然后，将词链表与hadoop的文档链表进行差操作，去除包含hadoop的文档，从而得到既包含lucene又包含learn而且不包含hadoop的文档链表</p>
<p><strong>第四步：根据得到的文档和查询语句的相关性，对结果进行排序。</strong></p>
<p>判断词（Term）之间的关系从而得到文档相关性的过程应用一种叫做向量空间模型的算法</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-视频排行榜———HashMap合并-List排序" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/29/视频排行榜———HashMap合并-List排序/" class="article-date">
  	<time datetime="2016-07-29T07:06:28.000Z" itemprop="datePublished">2016-07-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/29/视频排行榜———HashMap合并-List排序/">视频排行榜——HashMap合并 List排序</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>本文用于实现多家视频的点击量合并成一个视频排行榜</p>
<font color="red">备注：该项目采用了SpringMVC+Spring+Mybatis框架</font>

<p>这是一个视频类</p>
<pre><code>public class TopVideo {
private String name;
private String category;
private Timestamp time;
private long view; 

public String getName() {
    return name;
}
public void setName(String name) {
    this.name = name;
}
public String getCategory() {
    return category;
}
public void setCategory(String category) {
    this.category = category;
}
public long getView() {
    return view;
}
public void setView(long view) {
    this.view = view;
}
public Timestamp getTime() {
    return time;
}
public void setTime(Timestamp time) {
    this.time = time;
}
}
</code></pre><p>1.把List<topvideo>读入到一个HashMap<string,topvideo>中，让List中name相同的数据进行合并（主要是进行播放量的相加）</string,topvideo></topvideo></p>
<p>2.再把HashMap中的Value字段读入到ArrayList进行排序</p>
<p><strong>对List中的某个属性进行排序</strong></p>
<blockquote>
<p>按照List中对象的Int类型属性</p>
<pre><code>@SuppressWarnings(&quot;unchecked&quot;)  
public static void sortIntMethod(List list){  
Collections.sort(list, new Comparator(){  
    @Override  
    public int compare(Object o1, Object o2) {  
        VideoTop video1=(VideoTop)o1;  
        VideoTop video2=(VideoTop)o2;  
        if(video1.getAge()&gt;video2.getAge()){  
            return 1;  
        }else if(video1.getAge()==video2.getAge()){  
            return 0;  
        }else{  
            return -1;  
        }  
    }             
});   
}  
</code></pre><p>按照List中对象的String类型的属性进行排序</p>
<pre><code>@SuppressWarnings(&quot;unchecked&quot;)  
public static void sortStringMethod(List list){  
Collections.sort(list, new Comparator(){  
    @Override  
    public int compare(Object o1, Object o2) {  
        Student video1=(VideoTop)o1;  
        Student video2=(VideoTop)o2;  
        return video1.getName().compareTo(video2.getName());  
    }             
});  
}  
</code></pre></blockquote>
<p>部分实现代码</p>
<pre><code>@SuppressWarnings({ &quot;unchecked&quot;, &quot;unchecked&quot; })
@Override
public List&lt;TopVideo&gt; selectTop(String category, Timestamp begin, Timestamp end) {
    Map&lt;String,Object&gt; params_youku = new HashMap&lt;&gt;();
    params_youku.put(&quot;begin&quot;, begin);
    params_youku.put(&quot;end&quot;, end);
    params_youku.put(&quot;category&quot;, category);

    List&lt;TopVideo&gt; youku =new LinkedList&lt;TopVideo&gt;();
    youku=videoMapper.selectTotalTop(params_youku);
    long views=0;

    Map&lt;String,TopVideo&gt; total=new HashMap&lt;&gt;();
    for(TopVideo y:youku){
        if(total.containsKey(y.getName())){
            views=total.get(y.getName()).getView();
            total.get(y.getName()).setView(views+y.getView());
        }
        else
            total.put(y.getName(),y);
    }


    List&lt;TopVideo&gt; youku_total=new ArrayList&lt;TopVideo&gt;();
    youku_total.addAll(total.values());
    Collections.sort(youku_total, new Comparator&lt;Object&gt;(){
        public int compare(Object o1,Object o2){
            TopVideo video1=(TopVideo)o1;
            TopVideo video2=(TopVideo)o2;
            if(video1.getView()&gt;video2.getView()){
                return -1;
            }else if(video1.getView()==video2.getView()){
                return 0;
            }
            else{
                return 1;
            }
        }
    });
    List&lt;TopVideo&gt; youku_total_2=new ArrayList&lt;TopVideo&gt;();
    youku_total_2=youku_total.subList(0,10);  //获取list前十条数据
    return youku_total_2;
    }
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-图片下载程序中遇到的问题汇总" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/25/图片下载程序中遇到的问题汇总/" class="article-date">
  	<time datetime="2016-07-25T08:20:24.000Z" itemprop="datePublished">2016-07-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/25/图片下载程序中遇到的问题汇总/">图片下载程序中遇到的问题汇总</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>1.Java.lang.NoSuchFiledError: INSTANCE异常</strong></p>
<p>可能是包重复了，同一个包在项目中存在不同的版本</p>
<p>解决办法：同一种包只留一个版本*</p>
<p><strong>2.Exception in thread “main” java.lang.NOClassDefFoundError: org/apache/http/c</strong></p>
<p>项目没打包对</p>
<p>解决办法：打包的时候 Export选择Runnable JAR file*</p>
<p><strong>3.Unsupported major.minor version 52.0</strong></p>
<p>jdk的版本不对</p>
<p>解决办法：升级jdk到匹配的版本*</p>
<p><strong>4.DefaultHttpClient is deprecated</strong></p>
<p>在使用Apache的httpclient的时候，发现DefaultHttpClient等常用的类已经不推荐使用了</p>
<p>DefaultHttpClient -&gt; CloseableHttpClient</p>
<p>HttpResponse -&gt; CloseableHttpResponse</p>
<p>官方给出了新的api样例，如下。</p>
<p>Get方法：</p>
<pre><code>CloseableHttpClient httpclient = HttpClients.createDefault();
HttpGet httpGet = new HttpGet(&quot;http://targethost/homepage&quot;);
CloseableHttpResponse response1 = httpclient.execute(httpGet);
// The underlying HTTP connection is still held by the response object
// to allow the response content to be streamed directly from the network socket.
// In order to ensure correct deallocation of system resources
// the user MUST either fully consume the response content  or abort request
// execution by calling CloseableHttpResponse#close().
//建立的http连接，仍旧被response1保持着，允许我们从网络socket中获取返回的数据
//为了释放资源，我们必须手动消耗掉response1或者取消连接（使用CloseableHttpResponse类的close方法）

try {
    System.out.println(response1.getStatusLine());
    HttpEntity entity1 = response1.getEntity();
    // do something useful with the response body
    // and ensure it is fully consumed
    EntityUtils.consume(entity1);
} finally {
    response1.close();
}
</code></pre><p>Post方法：</p>
<pre><code>HttpPost httpPost = new HttpPost(&quot;http://targethost/login&quot;);
//拼接参数
List &lt;NameValuePair&gt; nvps = new ArrayList &lt;NameValuePair&gt;();
nvps.add(new BasicNameValuePair(&quot;username&quot;, &quot;vip&quot;));
nvps.add(new BasicNameValuePair(&quot;password&quot;, &quot;secret&quot;));
httpPost.setEntity(new UrlEncodedFormEntity(nvps));
CloseableHttpResponse response2 = httpclient.execute(httpPost);

try {
    System.out.println(response2.getStatusLine());
    HttpEntity entity2 = response2.getEntity();
    // do something useful with the response body
    // and ensure it is fully consumed
    //消耗掉response
    EntityUtils.consume(entity2);
} finally {
    response2.close();
}
</code></pre><p><strong>5.在Linux环境下抓取网页报 java.net.UnknownHostException:</strong></p>
<p>  DNS问题<br>  同样的代码，在windows下运行成功，到linux下就报错，查看了windows下的DNS</p>
<pre><code>ipconfig /all
</code></pre><p>  发现DNS是192.168.1.1 于是修改Linux的DNS</p>
<p>解决办法：修改DNS</p>
<pre><code>vi /ect/resolv.conf
nameserver 192.168.1.1
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-前端js的参数传递" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/13/前端js的参数传递/" class="article-date">
  	<time datetime="2016-07-13T08:12:26.000Z" itemprop="datePublished">2016-07-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/13/前端js的参数传递/">前端js的参数传递</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>项目中用到的 利用js往后台传递参数</p>
<h3 id="post方法"><a href="#post方法" class="headerlink" title="post方法"></a>post方法</h3><p>1）传递普通参数</p>
<pre><code>$.post(&quot;/TaveenConsole/video/changepwdsuccess&quot; , 
{password:encodeURI(passwordValue),oldpwd:encodeURI(oldpwd)} , 
function(data , status){
var result = JSON.parse(data.result).ret_code;

if(result == &quot;0&quot;){
    alert(&quot;密码修改成功!&quot;);
     window.location.href=&quot;/TaveenConsole/video/homepage&quot;;
} 
else if(result == &quot;1&quot;) {
    alert(&quot;密码修改失败!&quot;);
} else if(result == &quot;2&quot;) {
alert(&quot;原密码错误，修改失败&quot;)；
window.location.href=window.location.href; //刷新当前页面
}
            });
    });
</code></pre><p>2）传递json类型的参数</p>
<pre><code>$.ajax({
        type: &quot;POST&quot;,
        url: &quot;/Service/SimpleData&quot;,
        contentType: &quot;application/json&quot;, //必须有
        dataType: &quot;json&quot;, //表示返回值类型，不必须
        data:JSON.stringify({&apos;username&apos;:username,&apos;password&apos;:passwordValue,&apos;oldpwd&apos;:oldpwd}),
        success: function (jsonResult) {
            alert(jsonResult);
        }
    });
</code></pre><h3 id="get方法"><a href="#get方法" class="headerlink" title="get方法"></a>get方法</h3><pre><code>$(&quot;#update-node-buttton&quot;).click(function() {
    isUpdate = true; // 点击保存则是更新

    var url = &quot;/TaveenSetting/video/getdatabyid/&quot; + updateId;
    $.get(url, function(data,status){
        if(data.result == 0) { //获取成功
            ...
        }
    });
});
</code></pre><p>GET请求的数据会附在URL之后（就是把数据放置在HTTP协议头中），以?分割URL和传输数据，参数之间以&amp;相连。GET方法提交的数据最多只能是1024字节，理论上POST没有限制。POST的安全性要比GET的安全性高。</p>
<font color="red">更新于2016年7月29日</font>

<p>1.根据HTTP规范，GET用于信息获取，而且应该是安全和幂等的</p>
<p>（1）所谓的安全意味着该操作用于获取信息而非修改信息。换句话说，GET请求一般不应该产生副作用，就是说，它仅仅是获取资源信息，就像数据库查询一样，不会修改，增加数据，不会影响资源的状态。</p>
<p>（2）幂等意味着对同一URL的多个请求应该返回同样的结果。幂等指的是对最终数据状态来讲的，举个例子，get每次用来获取最新的十条新闻数据可能都是不一样，但仍然是幂等的，因为从server端来讲，数据状态并没有发生任何改变。（前提是server在正常的工作状态下）</p>
<p>2.根据HTTP规范，POST表示可能修改服务器上的资源请求</p>
<p>“GET方式提交的数据最多只能是1024字节”，因为GET是通过URL提交数据，那么GET可提交的数据量就跟URL的长度有直接关系了。而实际上，URL不存在参数上限的问题，HTTP协议规范没有对URL长度进行限制。这个限制是特定的浏览器及服务器对它的限制。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-使用ajax-springmvc的controller无法页面跳转" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/12/使用ajax-springmvc的controller无法页面跳转/" class="article-date">
  	<time datetime="2016-06-12T07:04:02.000Z" itemprop="datePublished">2016-06-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/12/使用ajax-springmvc的controller无法页面跳转/">使用ajax springmvc的controller无法页面跳转</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>问题</strong></p>
<p>在使用ajax传递数据给controller并实现页面跳转时，发现controller中return的页面无法跳转成功，可能原因：ajax不提供跳转功能。</p>
<p><strong>解决办法</strong></p>
<p>如果想要实现上诉功能的话可以使用window.location.href=”xxxx.do”,这样访问我们的controller之后可以实现页面跳转，并且放在ModelAndView中的数据可以在下一个页面中取到。</p>
<p>html代码</p>
<pre><code>&lt;div class=&quot;cart&quot;&gt;
&lt;a href=&quot;javascript:void(0)&quot; onclick=&quot;buy()&quot; class=&quot;bay&quot; &gt;立即购买&lt;/a&gt;
&lt;a href=&quot;#&quot; class=&quot;bay&quot;&gt;加入购物车&lt;/a&gt;
&lt;input type=&quot;text&quot; id=&quot;number&quot; class=&quot;number&quot; value=&quot;1&quot; /&gt;
&lt;span&gt;Quantity:&lt;/span&gt;&lt;/div&gt;
</code></pre><p>js代码</p>
<pre><code>function buy(){
var goodID=101; 
var number=$(&quot;#number&quot;).val();
var cost=$(&quot;#price_new&quot;).text();

$.ajax({  
    type: &quot;GET&quot;,  
    success:function(data){  
    window.location.href =&apos;&lt;%=path%&gt;/buy.do?goodID=&apos; + goodID + &apos;&amp;number=&apos;+number +&apos;&amp;price=&apos;+cost;  
    },
     //dataType: &apos;json&apos;,  
}); 
}
</code></pre><p>controller代码</p>
<pre><code>@RequestMapping(value = &quot;buy&quot;, method = RequestMethod.GET)
public ModelAndView buy(HttpServletRequest request) throws Exception {

     String goodID = request.getParameter(&quot;goodID&quot;);
     String number = request.getParameter(&quot;number&quot;);  
     String price =request.getParameter(&quot;price&quot;);



            ModelAndView mav = new ModelAndView(&quot;checkout&quot;);

            mav.addObject(&quot;goodID&quot;, goodID);
            mav.addObject(&quot;number&quot;, number);
            mav.addObject(&quot;price&quot;,price);
            System.out
                    .println(&quot;goodID=&quot; + goodID + &quot; number=&quot; + number+ &quot; price=&quot;+ price);

            return mav ;

}
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Spring-MVC程序中得到网页的静态资源文件css-js-图片" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/19/Spring-MVC程序中得到网页的静态资源文件css-js-图片/" class="article-date">
  	<time datetime="2016-05-19T03:07:58.000Z" itemprop="datePublished">2016-05-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/19/Spring-MVC程序中得到网页的静态资源文件css-js-图片/">Spring MVC程序中得到网页的静态资源文件css,js,图片</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>运行一个springmvc程序，发现网页样式显示不出来，调试显示404 not found，而路径肯定没错，就算在web.xml中配置的是</p>
<pre><code> &lt;servlet-mapping&gt;  
    &lt;servlet-name&gt;MVC&lt;/servlet-name&gt;  
    &lt;url-pattern&gt;*.do&lt;/url-pattern&gt; 

&lt;/servlet-mapping&gt; 
</code></pre><p>还是存在问题</p>
<p><strong>解决办法</strong></p>
<p>使用spring mvc resource去读取静态文静</p>
<p>比如在WEN-INF下建立resource文件夹，并在resource文件夹里面建立css文件夹</p>
<p>修改mvc-content.xml文件</p>
<pre><code>&lt;mvc:resources mapping=&quot;/resource/**&quot; location=&quot;/WEB-INF/resource/&quot;/&gt;
</code></pre><p>并且在web.xml文件中，修改一下部分</p>
<pre><code> &lt;servlet-mapping&gt;  
    &lt;servlet-name&gt;MVC&lt;/servlet-name&gt;  
    &lt;url-pattern&gt;*.do&lt;/url-pattern&gt; 
    &lt;url-pattern&gt;*.css&lt;/url-pattern&gt; 
    &lt;url-pattern&gt;*.js&lt;/url-pattern&gt; 
    &lt;url-pattern&gt;*.png&lt;/url-pattern&gt; 
    &lt;url-pattern&gt;*.jpg&lt;/url-pattern&gt; 
&lt;/servlet-mapping&gt; 
</code></pre><p>这样配置之后，可以通过 <a href="http://your-ip:port/your-app/resource/css/style.css" target="_blank" rel="external">http://your-ip:port/your-app/resource/css/style.css</a> </p>
<p>&lt;%@ page language=”java” import=”java.util.*” pageEncoding=”gbk”%&gt;<br>&lt;%<br>String path = request.getContextPath();<br>String basePath = request.getScheme()+”://“+request.getServerName()+”:”+request.getServerPort()+path+”/“;<br>%&gt;</p>
<p>&lt;!DOCTYPE HTML PUBLIC “-//W3C//DTD HTML 4.01 Transitional//EN”&gt;</p>
<html><br><head><br><base href="<%=basePath%>"><br><meta http-equiv="Content-Type" content="text/html; charset=gbk"><br><title>Insert title here</title><br></head><br><body><br>    <form action="regist.do" method="post"><br>        username:<input type="text" name="username"><br>        <p><br>            password:<input type="password" name="password"><br>        </p><p><br>            <input type="submit" value="submit"><br>    </p></form><br></body><br></html>

<p>Expected one result (or null) to be returned by selectOne(), but found 2<br>数据库满足条件的数据有两条</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-springMVC-Mybatis框架搭建实例" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/12/springMVC-Mybatis框架搭建实例/" class="article-date">
  	<time datetime="2016-05-12T07:07:49.000Z" itemprop="datePublished">2016-05-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/12/springMVC-Mybatis框架搭建实例/">springMVC+Mybatis框架搭建实例</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="SpringMvc4-Mybatis3框架搭建实例"><a href="#SpringMvc4-Mybatis3框架搭建实例" class="headerlink" title="SpringMvc4+Mybatis3框架搭建实例"></a>SpringMvc4+Mybatis3框架搭建实例</h1><p><em>前景摘要</em></p>
<blockquote>
<p><strong>为什么要使用springMVC？springMVC和struts2有什么区别？</strong></p>
<p>spring Web MVC是一种基于Java的实现了Web MVC设计模式的请求驱动类型的轻量级Web框架，即使用了MVC架构模式的思想，将web层进行职责解耦，基于请求驱动指的就是使用请求-响应模型，框架的目的就是帮助我们简化开发</p>
<p>1.springmvc基于方法开发的，struts2基于类开发的。springmvc将url和controller里的方法映射。映射成功后springmvc生成一个Handle对象，对象中只包括了一个method。方法执行结束，形参数据销毁。springmvc的controller开发类似web service开发。</p>
<p>2.springmvc可以进行单例开发，并且建议使用单例开发，struts通过类的成员变量接受参数，无法使用单例，是能使用多例</p>
<p>3.通过实际测试，struts2速度慢，在于使用struts标签，如果使用struts建议使用jstl</p>
<p><strong>MyBatis是什么</strong></p>
<p>MyBatis的前身叫iBatis，本是apache的一个开源项目，2010年这个项目由apache software迁移到了google code，并且改名为MyBatis。MyBatis是支持普通SQL查询，存储过程和高级映射的优秀持久层框架。</p>
<p>MyBatis消除了几乎所有的JDBC代码和参数的手工设置以及结果集的检索。MyBatis使用简单的XML或注解用于配置和原始映射，将接口和Java的POJOs（Plan Old Java Objects，普通的Java对象）映射成数据库中的记录。</p>
</blockquote>
<p>一.环境</p>
<p>Eclipse+Tomcat8+mysql+JDK1.8</p>
<p>二.导入的jar包</p>
<p><img src="http://7xruqa.com1.z0.glb.clouddn.com/jar.PNG" alt=""></p>
<p>三.数据库文件</p>
<pre><code>create table test
( 
   id         VARCHAR(50) not null,
   name       VARCHAR(50),
   password   VARCHAE(50)
 )
insert into users(id,name,password)VALUES(&quot;1&quot;,&quot;admin&quot;,&quot;admin&quot;)
</code></pre><p>四.工程结构</p>
<p><img src="http://7xruqa.com1.z0.glb.clouddn.com/%E5%B7%A5%E7%A8%8B%E6%88%AA%E5%9B%BE.PNG" alt=""></p>
<p>五.Java相关文件</p>
<p>1.配置文件</p>
<p><1> spring-mvc的配置</1></p>
<p>mvc-context.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
xsi:schemaLocation=&quot;
http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
http://www.springframework.org/schema/context 
http://www.springframework.org/schema/context/spring-    context-3.0.xsd
http://www.springframework.org/schema/mvc
http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd&quot;&gt;
&lt;!-- &lt;context:component-scan base-package=&quot;com.wg&quot; /&gt; --&gt;


 &lt;context:component-scan base-package=&quot;com.wg.bean&quot;/&gt; 
 &lt;context:component-scan base-package=&quot;com.wg.mapper&quot;/&gt;  
 &lt;context:component-scan base-package=&quot;com.wg.service&quot;/&gt;

&lt;context:component-scan base-package=&quot;com.wg.controller&quot;/&gt;

&lt;mvc:annotation-driven /&gt;

&lt;bean id=&quot;viewResolver&quot;
    class=&quot;org.springframework.web.servlet.view.UrlBasedViewResolver&quot;&gt;
    &lt;property name=&quot;viewClass&quot;
        value=&quot;org.springframework.web.servlet.view.JstlView&quot; /&gt;
    &lt;property name=&quot;prefix&quot; value=&quot;/page/&quot; /&gt;
    &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot; /&gt;
&lt;/bean&gt;
&lt;/beans&gt;
</code></pre><p><2> mybatis配置</2></p>
<p>root-context.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;      
   xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;      
   xmlns:p=&quot;http://www.springframework.org/schema/p&quot;      
   xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;      
   xmlns:context=&quot;http://www.springframework.org/schema/context&quot;      
   xmlns:util=&quot;http://www.springframework.org/schema/util&quot;      
   xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans   
        http://www.springframework.org/schema/beans/spring-beans-4.1.xsd      
        http://www.springframework.org/schema/context   
        http://www.springframework.org/schema/context/spring-context-4.1.xsd      
        http://www.springframework.org/schema/mvc   
        http://www.springframework.org/schema/mvc/spring-mvc-4.1.xsd      
        http://www.springframework.org/schema/util   
        http://www.springframework.org/schema/util/spring-util-4.1.xsd&quot;&gt;   

&lt;!-- Root Context: defines shared resources visible to all other web components --&gt;
&lt;!-- 配置DataSource数据源 --&gt;
&lt;!-- &lt;context:component-scan base-package=&quot;com.wg&quot; /&gt; --&gt; 

&lt;!-- 数据源：DriverManagerDataSource --&gt;
&lt;bean id=&quot;datasource&quot; class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt;
&lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;
&lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/test&quot;/&gt;
&lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
&lt;property name=&quot;password&quot; value=&quot;123456&quot;/&gt;
&lt;/bean&gt;

&lt;!-- 创建SqlSessionFactory，同时指定数据源 --&gt;
&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
    &lt;property name=&quot;dataSource&quot; ref=&quot;datasource&quot; /&gt;
    &lt;property name=&quot;typeAliasesPackage&quot; value=&quot;com.wg.bean&quot;/&gt;
    &lt;property name=&quot;configLocation&quot; value=&quot;classpath:mybatis-config.xml&quot;&gt;&lt;/property&gt;
&lt;/bean&gt;

 &lt;!-- mybatis自动扫描加载SQL映射文件 ： MapperScannerConfigurer  --&gt;    
 &lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;
&lt;property name=&quot;basePackage&quot; value=&quot;com.wg.mapper&quot;/&gt;

&lt;/bean&gt;

&lt;!-- 事务管理:DataSourceTransactionManager --&gt;
&lt;bean id=&quot;manager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;
&lt;property name=&quot;dataSource&quot; ref=&quot;datasource&quot;/&gt;&lt;/bean&gt;

&lt;/beans&gt;
</code></pre><p>mybatis-config.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;  
&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
&lt;configuration&gt;
&lt;typeAliases&gt;
    &lt;package name=&quot;com.wg.bean&quot; /&gt;
&lt;/typeAliases&gt;
&lt;mappers&gt;
    &lt;mapper resource=&quot;com/wg/mapper/UserMapper.xml&quot; /&gt;
&lt;/mappers&gt;
&lt;/configuration&gt;
</code></pre><p><3> web.xml配置</3></p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;  
&lt;web-app version=&quot;3.0&quot; xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot;  
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;  
xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee   
http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;&gt;  

&lt;!-- 监听spring上下文容器 --&gt;  


&lt;!-- 加载spring的xml配置文件到 spring的上下文容器中 --&gt;  
&lt;context-param&gt;  
    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;  
    &lt;param-value&gt;classpath:root-context.xml&lt;/param-value&gt;  
&lt;/context-param&gt; 
 &lt;listener&gt;  
    &lt;listener-class&gt;  
        org.springframework.web.context.ContextLoaderListener  
    &lt;/listener-class&gt;  
&lt;/listener&gt;  

&lt;!-- 配置Spring MVC DispatcherServlet --&gt;  
&lt;servlet&gt;  
    &lt;servlet-name&gt;MVC&lt;/servlet-name&gt;  
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;  
    &lt;!-- 初始化参数 --&gt;  
    &lt;init-param&gt;  
        &lt;!-- 加载SpringMVC的xml到 spring的上下文容器中 --&gt;  
        &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;  
        &lt;param-value&gt;  
            /WEB-INF/classes/mvc-context.xml  
        &lt;/param-value&gt;  
    &lt;/init-param&gt;  
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;  
&lt;/servlet&gt;  

&lt;!-- 配置DispatcherServlet所需要拦截的 url --&gt;  
&lt;servlet-mapping&gt;  
    &lt;servlet-name&gt;MVC&lt;/servlet-name&gt;  
    &lt;url-pattern&gt;*.do&lt;/url-pattern&gt;  
&lt;/servlet-mapping&gt;  

&lt;welcome-file-list&gt;  
    &lt;welcome-file&gt;/page/login.jsp&lt;/welcome-file&gt;  
&lt;/welcome-file-list&gt;  


&lt;/web-app&gt;  
</code></pre><p>2.java 文件</p>
<p><1> bean类</1></p>
<p>User.java</p>
<pre><code>package com.wg.bean;

public class User {
private Long id;
private String username;
private String password;

public Long getId() {
    return id;
}

public void setId(Long id) {
    this.id = id;
}

public String getUsername() {
    return username;
}

public void setUsername(String username) {
    this.username = username;
}

public String getPassword() {
    return password;
}

public void setPassword(String password) {
    this.password = password;
}

@Override
public String toString() {
    return &quot;User [username=&quot; + username + &quot;, password=&quot; + password + &quot;]&quot;;
}

}
</code></pre><p><2> mapper类</2></p>
<p>UserMapper.java</p>
<pre><code>package com.wg.mapper;


import java.util.List;
import org.apache.ibatis.annotations.Param;
import org.springframework.stereotype.Repository;

import com.wg.bean.User;
//userMapper只能传入一个参数,多个的话需要注解

public interface UserMapper {
//value 必须与Bean 属性一致！
public User findUserByName(@Param(&quot;username&quot;) String username);

public String getUsernameById(@Param(&quot;id&quot;) int id);    

}
</code></pre><p>UserMapper.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
&lt;mapper namespace=&quot;com.wg.mapper.UserMapper&quot;&gt;  
&lt;resultMap type=&quot;User&quot; id=&quot;userResult&quot;&gt;
&lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;
&lt;result property=&quot;username&quot; column=&quot;username&quot;/&gt;
&lt;result property=&quot;password&quot; column=&quot;password&quot;/&gt;
&lt;/resultMap&gt;  
&lt;select id=&quot;findUserByName&quot; parameterType=&quot;User&quot; resultMap=&quot;userResult&quot;&gt;
    select id, username , password from user where username = #{username} 
&lt;/select&gt;

&lt;select id=&quot;getUsernameById&quot; resultType=&quot;String&quot;&gt;
    select username  from user where id = #{id} 
&lt;/select&gt;
&lt;/mapper&gt;
</code></pre><p><3> Service类</3></p>
<p>UserService.java</p>
<pre><code>package com.wg.service;

import java.util.List;


import com.wg.bean.User;

public interface UserService {

public User findUserByName(String username) throws Exception;
public String getUsernameById(int id) throws Exception;
}
</code></pre><p>UserServiceImpl.java</p>
<pre><code>package com.wg.service;

import java.util.List;

//import javax.annotation.Resource;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.wg.bean.User;
import com.wg.mapper.UserMapper;
import com.wg.service.UserService;

@Service(&quot;UserService&quot;)

public class UserServiceImpl implements UserService {

@Autowired
//@Resource
public UserMapper userMapper;

public User findUserByName(String username) {
    return userMapper.findUserByName(username);
}

public String getUsernameById(int id){  
    System.out.println(&quot;数据库中查到此用户号[&quot; + id + &quot;]对应的用户名为[&quot; + userMapper.getUsernameById(id) + &quot;]&quot;);  
    return userMapper.getUsernameById(id);  
}

}
</code></pre><p><4> Controller类</4></p>
<p>UserController.java</p>
<pre><code>package com.wg.controller;

import java.util.HashMap;
import java.util.Map;

import javax.annotation.Resource;
import javax.servlet.http.HttpServletRequest;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.util.DigestUtils;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.servlet.ModelAndView;
import com.wg.bean.User;
import com.wg.mapper.UserMapper;
   import com.wg.service.UserService;

@Controller
public class UserController {

@Autowired
//private UserMapper usermapper;

private UserService userService;
//private UserService userService;

/*@RequestMapping(value = &quot;regist&quot;, method = RequestMethod.POST)
public ModelAndView regist(HttpServletRequest request, User user) {
    try {
        userService.saveUser(user);
    } catch (Exception e) {
        e.printStackTrace();
    }
    request.setAttribute(&quot;username&quot;, user.getUsername());
    request.setAttribute(&quot;password&quot;, user.getPassword());
    System.out.println(user.toString());
    return new ModelAndView(&quot;succ&quot;);
}*/

/***
 * 用户登陆
 * &lt;p&gt;
 * 注解配置，只允许POST提交到该方法
 * 
 * @param username
 * @param password
 * @return
 * @throws Exception 
 */
@RequestMapping(value = &quot;login&quot;, method = RequestMethod.POST)
public ModelAndView login(HttpServletRequest request,@RequestParam String username, @RequestParam String password) throws Exception {
    // 验证传递过来的参数是否正确，否则返回到登陆页面。
    User user_login=userService.findUserByName(username);
    if(user_login!=null){
        if(user_login.getPassword().equals(password)){
            request.getSession().setAttribute(&quot;userId&quot;, user_login.getId());
            request.getSession().setAttribute(&quot;user&quot;, username);

            ModelAndView mav = new ModelAndView(&quot;succ&quot;);
            // 将参数返回给页面
            mav.addObject(&quot;username&quot;, username);
            mav.addObject(&quot;password&quot;, password);
            System.out
                    .println(&quot;username=&quot; + username + &quot; password=&quot; + password);
            return mav;
        }

    }
    /*if (this.checkParams(new String[] { username, password })) {
        // 指定要返回的页面为succ.jsp
        ModelAndView mav = new ModelAndView(&quot;succ&quot;);
        // 将参数返回给页面
        mav.addObject(&quot;username&quot;, username);
        mav.addObject(&quot;password&quot;, password);
        System.out
                .println(&quot;username=&quot; + username + &quot; password=&quot; + password);
        return mav;
    }*/
    return new ModelAndView(&quot;home&quot;);
}

/***
 * 验证参数是否为空
 * 
 * @param params
 * @return
 */
private boolean checkParams(String[] params) {
    for (String param : params) {
        if (param == &quot;&quot; || param == null || param.isEmpty()) {
            return false;
        }
    }
    return true;
}
}
</code></pre><p>HomeController.java</p>
<pre><code>package com.wg.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

@Controller
public class HomeController {

/***
 * 首页 返回至/page/home.jsp页面
 * 
 * @return
 */
@RequestMapping(&quot;hello&quot;)
public ModelAndView index() {
    // 创建模型跟视图，用于渲染页面。并且指定要返回的页面为home页面
    ModelAndView mav = new ModelAndView(&quot;home&quot;);
    return mav;
}
}
</code></pre><p>3.jsp文件</p>
<p>login.jsp</p>
<pre><code>&lt;%@ page language=&quot;java&quot; import=&quot;java.util.*&quot; pageEncoding=&quot;gbk&quot;%&gt;
&lt;%
String path = request.getContextPath();
String basePath = request.getScheme()+&quot;://&quot;+request.getServerName()+&quot;:&quot;+request.getServerPort()+path+&quot;/&quot;;
%&gt;

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;base href=&quot;&lt;%=basePath%&gt;&quot;&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=gbk&quot;&gt;
&lt;title&gt;Insert title here&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form action=&quot;login.do&quot; method=&quot;post&quot;&gt;
    username:&lt;input type=&quot;text&quot; name=&quot;username&quot; /&gt;
    &lt;p&gt;
        password:&lt;input type=&quot;password&quot; name=&quot;password&quot; /&gt;
    &lt;p&gt;
        &lt;input type=&quot;submit&quot; value=&quot;submit&quot; /&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>succ.jsp</p>
<pre><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=GB18030&quot;
pageEncoding=&quot;GB18030&quot;%&gt;
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=GB18030&quot;&gt;
&lt;title&gt;home&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h2&gt;登陆&lt;/h2&gt;

username:${username }
&lt;p&gt;password:${password }
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>home.jsp</p>
<pre><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=GB18030&quot;
pageEncoding=&quot;GB18030&quot;%&gt;
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=GB18030&quot;&gt;
&lt;title&gt;home&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h2&gt;spring mvc 实例&lt;/h2&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p><font color="red"><strong>遇到的一些问题：</strong><b></b></font></p>
<p>1.Tomcat无法运行：可能是web.xml配置的有问题</p>
<p>2.UserService无法注入：Service要写成接口的形式，ServiceImpl前面要有@Service(“UserService”)</p>
<p>3.nested exception is java.lang.ClassNotFoundException: org.mybatis.spring.Sql :<br>在web.xml中要有</p>
<pre><code>&lt;listener&gt;  
 &lt;listener-class&gt;  
   org.springframework.web.context.ContextLoaderListener  
 &lt;/listener-class&gt;  
&lt;/listener&gt;  
</code></pre><p>页面出现404，500等错误时，从eclipse控制台中可以查看到出错的原因</p>
<p>4.MyBatis： Parameter Map collection does not contain value for :SQL映射的XML文件：parameterMap 已经废弃了，现在使用parameterType来处理</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Mai Taozi
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>